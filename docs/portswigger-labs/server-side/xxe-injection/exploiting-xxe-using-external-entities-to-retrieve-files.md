---
description: https://portswigger.net/web-security/xxe/lab-exploiting-xxe-to-retrieve-files
---

# Exploiting XXE using external entities to retrieve files

<figure><img src="../../../.gitbook/assets/1 (156).png" alt=""><figcaption></figcaption></figure>

Let's check the stock of one of the products.

<figure><img src="../../../.gitbook/assets/2 (11).png" alt=""><figcaption></figcaption></figure>

Since we are proxying the requests through Burp Suite, we can go to `Proxy > HTTP History` to view the request.

<figure><img src="../../../.gitbook/assets/3 (11).png" alt=""><figcaption></figcaption></figure>

We can see that the request contains an XML entity.

Let's forward this request to the `Repeater` for further modification.

Once in the `Repeater` tab, declare the following internal entity after the XML prologue:

```
<!DOCTYPE test 
[<!ENTITY test "test_entity">]
>
```

And reference the entity within the `<productId>` tag as follows:

```
<productId>
    &test;
</productId>
```

<figure><img src="../../../.gitbook/assets/4 (8).png" alt=""><figcaption></figcaption></figure>

The response includes out `test` entity. This tells us that the application is vulnerable to XXE injection.

Now, in place of the internal entity, declare the following entity:

```
<!DOCTYPE test 
[<!ENTITY test SYSTEM "file:///etc/passwd">]
>
```

<figure><img src="../../../.gitbook/assets/5 (9).png" alt=""><figcaption></figcaption></figure>

We have solved the lab.

<figure><img src="../../../.gitbook/assets/7 (7).png" alt=""><figcaption></figcaption></figure>
